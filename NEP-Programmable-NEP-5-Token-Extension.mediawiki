<pre>
  NEP: <to be assigned>
  Title: Programmable NEP-5 Token Extension
  Authors: Dean van Dugteren (dean@nos.io), Jeroen Peeters (contact@jeroenpeeters.me)
  Type: Standard
  Status: Draft
  Created: 2018-08-09
  Requires: NEP-5
</pre>

==Abstract==

This NEP introduces a memory-efficient method for allowing conditional NEP-5 token transactions between users and third party smart contracts without the need for off-chain listeners. The methods take into account future changes in invocation fees, so as to make it work efficiently in multiple scenarios.

==Motivation==
All tokens should be ''programmable''. By programmable we mean that tokens should be conditionally transacted and held between users and smart contracts alike.

Presently, dApp smart contracts handle conditional transactions (e.g. staking a NEP5 token with a release condition) via off-chain listeners that send invocations based on certain triggers such as NEP5 Transaction Notification events.

This NEP proposes the following solution:


* A separate transfer method and operation <code>transferToContract(from, to, amount, operation, args)</code> that makes a transaction and calls a dynamic invocation on the <code>to</code> script hash, using <code>(string) from, (string) to, (bigint) amount, (string) operation, (list) args</code> as the parameters to be used in the dynamic invocation.

The ''transferToContract'' operation can be called by web-based applications integrating with ''neon-js'', nOS dApps, and applications utilizing NeoLink or the NEX plug-in. Additionally, wallet applications such as ''Neon Wallet'' can present the user with an option whether their transaction is intended for a user or a smart contract (effectively switching between ''transfer'' and ''transferToContract'' operations).

To achieve this, the NEP-5 token will need to be able to make dynamic invocations.

==Specification==

We propose the following methods to be implemented in any token contract that is looking to have a memory-efficient ''programmable'' NEP5 token:

[[File:https://user-images.githubusercontent.com/31391056/43914635-b34ed8c8-9c08-11e8-8f94-6e6146c4ec00.png]]

===Methods===

====transferToContract====

* Syntax: <code>public static bool transferToContract(from, to, amount, operation, args)</code>

* Remarks: This method (with operation ''transerToContract'') executes the NEP5 token's <code>transfer(from, to, amount)</code> function, and dynamically invokes the script hash derived from the <code>to</script> parameter, providing <code>from, to, amount, operation, args</code> as parameters for the receiving smart contract.

==Implementation==
TBD
